id: green_taxi_2020_full_load
namespace: zoomcamp

inputs:
  - id: taxi
    type: STRING
    defaults: green

  - id: year
    type: STRING
    defaults: "2020"

tasks:
  - id: load_all_months
    type: io.kestra.plugin.core.flow.EachSequential
    value: ["01","02","03","04","05","06","07","08","09","10","11","12"]
    tasks:
      - id: load_month
        type: io.kestra.plugin.core.flow.Subflow
        namespace: zoomcamp
        flowId: 04_postgres_taxi
        inputs:
          taxi: "{{inputs.taxi}}"
          year: "{{inputs.year}}"
          month: "{{taskrun.value}}"